# Workscope-20260129-155945

## Workscope ID
20260129-155945

## Navigation Path
1. `docs/core/Action-Plan.md` (Phase 0, item 0.4)
2. `docs/tickets/open/upgrade-trial-data-schema-1-3.md`

## Phase Inventory (Terminal Checkboxlist)

**Document:** `docs/tickets/open/upgrade-trial-data-schema-1-3.md`

```
PHASE INVENTORY FOR upgrade-trial-data-schema-1-3.md:
Phase 1: 1.1 - Modify the assistant message parsing loop to extract usage data
Phase 2: 2.1 - For each detected reset, look up the assistant message's full usage data
Phase 3: 3.1 - When `tool-results/` directory exists, enumerate its files
Phase 4: 4.1 - Compute `initial_cache_read` from the first `token_progression` entry
Phase 5: 5.1 - Update `schema_version` from `"1.2"` to `"1.3"`
Phase 6: 6.1 - Update Trial-Analysis-Guide.md Section 3.4
Phase 7: 7.1 - Run the updated script on FAILURE trial

FIRST AVAILABLE PHASE: Phase 1
FIRST AVAILABLE ITEM: 1.1 - Modify the assistant message parsing loop to extract usage data
```

## Selected Tasks

**Phase 1: Enhance Usage Data Extraction**

- [ ] **1.1** - Modify the assistant message parsing loop to extract `cache_creation_input_tokens`, `input_tokens`, and `output_tokens` from the JSONL `usage` object alongside the existing `cache_read_input_tokens` (see JSONL Field Name Mapping table above for source â†’ output field names)
- [ ] **1.2** - Add `cache_creation_tokens`, `input_tokens`, `output_tokens`, and `total_input` fields to each `token_progression` entry, where `total_input = cache_read_tokens + cache_creation_tokens + input_tokens`
- [ ] **1.3** - Store the full usage data per assistant message in a lookup structure keyed by `session_line` so it can be referenced for reset enrichment in Phase 2

**Total Leaf Tasks**: 3

## Phase 0 Status (Root Action Plan)

**Status**: BLOCKING

Phase 0 has available items:
- 0.4 - Update `trial_data.json` to Schema 1.3 (see `docs/tickets/open/upgrade-trial-data-schema-1-3.md`)

## Context Documents

**Primary Context:**
- docs/core/Action-Plan.md
- docs/tickets/open/upgrade-trial-data-schema-1-3.md

**Related Documentation:**
- docs/core/Design-Decisions.md
- docs/read-only/Agent-Rules.md

**Implementation Files:**
- dev/karpathy/extract_trial_data.py

**Command Documentation:**
- .claude/commands/update-trial-data.md

**Verification Data:**
- dev/misc/barebones-2121/20260128-150640/trial_data.json
- dev/misc/repro-attempts-04-2120/20260127-095002/trial_data.json

## Directive

None provided.
