# Workscope-20260118-144022

## Workscope ID
20260118-144022

## Navigation Path
1. `docs/core/Action-Plan.md` (Phase 4, item 4.2)
2. `docs/features/collect-trials-script/Collect-Trials-Script-Overview.md`

## Phase Inventory (Terminal Checkboxlist)

**Document:** `docs/features/collect-trials-script/Collect-Trials-Script-Overview.md`

```
PHASE INVENTORY FOR Collect-Trials-Script-Overview.md:
Phase 1: 1.1 - Create `src/collect_trials.py` with argument parsing
Phase 2: 2.1 - Implement export scanning functionality
Phase 3: 3.1 - Implement session file search
Phase 4: 4.1 - Implement single trial collection using unified algorithm
Phase 5: 5.1 - Implement progress output
Phase 6: 6.1 - Implement comprehensive integration tests
Phase 7: 7.1 - Update `docs/core/Experiment-Methodology-02.md`

FIRST AVAILABLE PHASE: Phase 1
FIRST AVAILABLE ITEM: 1.1 - Create `src/collect_trials.py` with argument parsing
```

## Selected Tasks

**Phase 1: Core Script Structure**

- [ ] **1.1** - Create `src/collect_trials.py` with argument parsing
  - [ ] **1.1.1** - Add shebang line (`#!/usr/bin/env python`) and module docstring
  - [ ] **1.1.2** - Implement argument parser with `-e/--exports` and `-d/--destination` required arguments
  - [ ] **1.1.3** - Add directory existence validation for both arguments
  - [ ] **1.1.4** - Implement exit codes (0 for success, 1 for error)
- [ ] **1.2** - Implement path encoding functions
  - [ ] **1.2.1** - Implement `encode_project_path()` function
  - [ ] **1.2.2** - Implement `derive_session_directory()` with DI support for `cwd_path` and `home_path`
- [ ] **1.3** - Create `tests/test_collect_trials.py` with Phase 1 tests
  - [ ] **1.3.1** - Create test file with module docstring and imports
  - [ ] **1.3.2** - Implement `TestArgumentParsing` class (5 tests: missing args, invalid paths, valid args)
  - [ ] **1.3.3** - Implement `TestEncodeProjectPath` class (3 tests: basic encoding, edge cases)
  - [ ] **1.3.4** - Implement `TestDeriveSessionDirectory` class (2 tests: with DI, path construction)

**Total Leaf Tasks**: 11

## Phase 0 Status (Root Action Plan)

**Status**: CLEAR

## Context Documents

**Primary Context:**
- docs/core/Action-Plan.md
- docs/features/collect-trials-script/Collect-Trials-Script-Overview.md

**Related Documentation:**
- docs/core/PRD.md
- docs/core/Experiment-Methodology-02.md
- docs/core/Design-Decisions.md

**Implementation Files:**
- src/cc_version.py (reference implementation for similar script)
- tests/test_cc_version.py (reference tests for similar script)

## Directive

None provided.

## Work Description

This workscope implements the foundational structure for the `collect_trials.py` script, which automates the collection and organization of phantom read trial artifacts from Claude Code sessions. Phase 1 focuses on:

1. **Script scaffolding**: CLI argument parsing with validation for exports and destination directories
2. **Path encoding logic**: Functions to handle Claude Code's session directory structure (encoding project paths and deriving session directories)
3. **Comprehensive testing**: Full test coverage for argument parsing and path encoding functions

This establishes the core infrastructure upon which export scanning, session discovery, and file collection features will be built in subsequent phases.
